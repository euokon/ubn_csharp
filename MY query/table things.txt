1.
create table dw_agn_txn_tbl as
select a.userid,
      a.dr_acct_no,
      a.channel,
      a.dr_narration, 
      b.txn_ref_no,
      b.txnid,
      b.cr_account,
      b.txn_stamp,
      b.txn_type,
      b.txn_dttm,      
      b.fee_amt,
      b.servicecode,
      b.amount,
      b.ext_txn_ref_no,
      b.status,
      b.reversal_flag,
      c.induced,
      c.response,
      decode(a.resp_code,'00','Successful','failed')Response_code
from dw_wallet_agncore_txntbl a,
     dw_wallet_fin_txn b,
     msadeojo.tran_resp_codes_tmp c
where a.userid = b.user_id(+)
  and a.resp_code = c.resp_code(+)
  and trunc(b.txn_dttm) between '28sep2022' and '29sep2022';
  commit;

2.
create table dw_agn_data_tbl as 
select a.user_id agent_id,
       a.first_name agent_name,
       a.customer_code, 
       a.date_created creation_date,
       a.w_prd_code product_code,
       a.w_prd_desc product_desc,
       a.account_no,
       a.acc_branch, 
       a.status,
       a.ref_num,
       a.rm_code,
       c.address,
       c.rl_lga LGA,
       c.r_state state
from dw_agent_customer_master a,
     dw_agent_contact_info c
 where a.user_id = c.mobile_number(+);
 commit;

3.
-----pos_terminal_tbl
create table dw_pos_agentterminal_tbl as
select b.serial pos_serial_no,
b.yrpurchased year_purchased,
b.status pos_status,
h.user_id agent_id
  from 
   stg_pos_serial_status b
  left outer join 
  (select *
          from unionceva.terminal_master@cevadb
         where length(serial_no) = 11
           and (substr(serial_no, 0, 6) = 'G200WT' or
                substr(serial_no, 0, 7) in ('G20047F', 'G20047G', 'G2004RA'))
           and regexp_like(substr(serial_no, -2, 2), '^[^a-zA-Z]*$') -- New G2
           and status = 'A'
        union
        select *
          from unionceva.terminal_master@cevadb
         where length(serial_no) = 14
           and substr(serial_no, 0, 5) in ('10210', '10201')
           and regexp_like(substr(serial_no, -2, 2), '^[^a-zA-Z]*$') -- Android
           and status = 'A'
        union
        select *
          from unionceva.terminal_master@cevadb
         where serial_no = 'K3702Q86646')h  
          -- Old G2)
     
 on(b.serial= h.serial_no);
 commit;

4.
select prd_code, prd_name, application,status from unionceva.product@cevadb

create table agn_prod_tbl(
prod_id varchar2(10),
prod_code varchar2(50),
prod_name varchar(50),
application varchar(50),
status varchar2(5));
commit;


select * from agn_prod_tbl
for update;

5.
create table agn_service_tbl as
select distinct servicecode, 
case when servicecode ='AGCASHDEP' then 'Cash Deposit'
    when servicecode = 'AGCASHWTHD' then 'Cash withdrawal'
    when servicecode = 'AGENTCASHDEP' then 'Agent cash deposit'
    when servicecode ='AGENTFUND' then 'Agent Fund'
    when servicecode = 'AGENTFUNDREV' then 'Agent fund reversal'
    when servicecode = 'AGN2OWNAC' then 'Core Account Funding'
    when servicecode = 'AGNCRDCSHWTDOTH' then 'Cash withdrawal card other bank'
    when servicecode ='AGNCRDCSHWTDOWN' then  'Cashwithdrawal Card Union bank'
    when servicecode ='AGNCRDFTXNOTH' then 'Fundtransfer Card Otherbank'
    when servicecode ='AGNCRDFTXNOWN' then 'Fundtransfer Card Union bank'
    when servicecode ='AGNPAYBILLAIRTIME'then 'Paybill Airtime Recharge'
    when servicecode ='AGNPOSINS' then 'Unclear'
    when servicecode ='AGNSWEEPCOM' then 'Agent commission'
    when servicecode ='AGNWAL2WAL'   then 'Agent wallet to wallet'
    when servicecode ='AGNWALCLSR'  then  'Unclear'
    when servicecode ='CUSAC2WAL' then 'Customer account to wallet'
    when servicecode ='CUSWAL2OWNAC' then 'Customer wallet to union bank account'
    when servicecode ='CUSWAL2WAL' then 'Customer wallet to wallet'
    when servicecode ='EXTFUNDWAL' then 'External fund wallet'
    when servicecode ='WALAGNOTBANK 'then 'Fund transfer other bank'
    when servicecode ='WALAGNOWNBANK'then 'Fund Transfer Own Bank'
    when servicecode ='WALAGNTOOWNBANK'  then 'Unclear'
    when servicecode ='WALPAYBILLAGN' then 'Paybill'
    else 'Unmapped code'
end AS Description 
FROM unionceva.Wallet_fin_txn@cevadb 
where  reversal_flag = 'N'
and substr(txn_ref_no, 1, 1) <> 'R'

union 
select distinct trans_type,
case when trans_type ='AGCASHDEP' then 'Cash Deposit'
    when trans_type = 'AGCASHWTHD' then 'Cash withdrawal'
    when trans_type = 'AGENTCASHDEP' then 'Agent cash deposit'
    when trans_type ='AGENTFUND' then 'Agent Fund'
    when trans_type = 'AGENTFUNDREV' then 'Agent fund reversal'
    when trans_type = 'AGN2OWNAC' then 'Core Account Funding'
    when trans_type = 'AGNCRDCSHWTDOTH' then 'Cash withdrawal card other bank'
    when trans_type ='AGNCRDCSHWTDOWN' then  'Cashwithdrawal Card Union bank'
    when trans_type ='AGNCRDFTXNOTH' then 'Fundtransfer Card Otherbank'
    when trans_type ='AGNCRDFTXNOWN' then 'Fundtransfer Card Union bank'
    when trans_type ='AGNPAYBILLAIRTIME'then 'Paybill Airtime Recharge'
    when trans_type ='AGNPOSINS' then 'Unclear'
    when trans_type ='AGNSWEEPCOM' then 'Agent commission'
    when trans_type ='AGNWAL2WAL'   then 'Agent wallet to wallet'
    when trans_type ='AGNWALCLSR'  then  'Unclear'
    when trans_type ='CUSAC2WAL' then 'Customer account to wallet'
    when trans_type ='CUSWAL2OWNAC' then 'Customer wallet to union bank account'
    when trans_type ='CUSWAL2WAL' then 'Customer wallet to wallet'
    when trans_type ='EXTFUNDWAL' then 'External fund wallet'
    when trans_type ='WALAGNOTBANK 'then 'Fund transfer other bank'
    when trans_type ='WALAGNOWNBANK'then 'Fund Transfer Own Bank'
    when trans_type ='WALAGNTOOWNBANK'  then 'Unclear'
    when trans_type ='WALPAYBILLAGN' then 'Paybill'
    else 'Unmapped code'
end AS Description
from  unionceva.WALLET_AGNCORE_TXNTBL@cevadb
where resp_code <> '00';
commit;